var wordApp=angular.module("wordGame",["angularModalService"]);wordApp.constant("Configuration",{WordsListUrl:"https://brilliant-torch-9360.firebaseio.com/words.json",UsersUrl:"https://brilliant-torch-9360.firebaseio.com/users.json"}),window.wordApp.WordsService=function(a,b){var c=this;c.recentMangledWords=[];var d=function(){for(var a=0;a<=c.words.length-1;a++){for(var b,d,e=c.words[a].split(""),f=e.length;0!==f;)d=Math.floor(Math.random()*f),f-=1,b=e[f],e[f]=e[d],e[d]=b;c.words[a]=e.join("").toString()}},e=function(a){c.recentMangledWords.length<2?c.recentMangledWords.push(a):(c.recentMangledWords.shift(),c.recentMangledWords.push(a))};this.getWordsList=function(){return a.get(b.WordsListUrl)},this.setWordList=function(a){c.words=a,d()},this.getRandomWord=function(){var a=c.words[Math.floor(Math.random()*c.words.length)];return a in c.recentMangledWords?void this.getRandomWord():(e(a),a)}},window.wordApp.WordsService.$inject=["$http","Configuration"],window.wordApp.service("WordsService",window.wordApp.WordsService),window.wordApp.homeController=function(a,b,c,d){a.init=function(){a.model={show:!0},b.getWordsList().then(function(a){b.setWordList(a.data)},function(){})},a.start=function(){a.model.show=!1;var c=b.getRandomWord();d.addObserver("firstMangledWord",c)},a.viewScores=function(){a.model.show=!1,c.getScoreList().then(function(a){d.addObserver("scoreListReceived",a.data)},function(){})}},window.wordApp.homeController.$inject=["$scope","WordsService","SaveScoreService","pubsubProvider"],window.wordApp.controller("homeController",window.wordApp.homeController),window.wordApp.scoreList=function(){return{restrict:"AE",templateUrl:"src/scoreList/scoresListTemplate.html"}},window.wordApp.directive("scoreList",window.wordApp.scoreList),window.wordApp.scoreListController=function(a,b){function c(b){a.model.show=!0;var c,d=b,e=0;for(var f in d)d.hasOwnProperty(f)&&(c=d[f],a.scorelist[e]=c,e+=1)}a.model={show:!1},a.scorelist={},a.backToStart=function(){},a.init=function(){b.addListener("scoreListReceived",a,c)}},window.wordApp.scoreListController.$inject=["$scope","pubsubProvider"],window.wordApp.controller("scoreListController",window.wordApp.scoreListController),window.wordApp.pubsubProvider=function(a){var b={},c={},d=function(c,d,e){a.$broadcast(c,d?{item:d}:e),b[c]=this.addObserver},e=function(a,b,d){b.$on(a,function(a,b){d(b.item)}),c["on"+a]=this.addListener};return{observers:b,listeners:c,addObserver:d,addListener:e}},window.wordApp.pubsubProvider.$inject=["$rootScope"],window.wordApp.factory("pubsubProvider",window.wordApp.pubsubProvider),window.wordApp.SaveScoreService=function(a,b,c){var d=this;this.StartTimer=function(a,b){var d,e,f=a,g=setInterval(function(){d=parseInt(f/60,10),e=parseInt(f%60,10),d=10>d?"0"+d:d,e=10>e?"0"+e:e,b.textContent="00:"+e,--f<0&&(f=0,c.addObserver("timeout","test"),clearInterval(g))},1e3)},this.submitScore=function(c){return a.post(b.UsersUrl,c)},this.getMaxScore=function(a){var b=a/3,c=Math.floor(Math.pow(1.95,b));return d.maxScore=c,c},this.getScoreList=function(){return a.get(b.UsersUrl)}},window.wordApp.SaveScoreService.$inject=["$http","Configuration","pubsubProvider"],window.wordApp.service("SaveScoreService",window.wordApp.SaveScoreService),window.wordApp.controller("ModalController",function(a,b){a.close=function(a){b(a,500)}}),window.wordApp.wordEntryController=function(a,b,c,d,e){function f(a){e.showModal({templateUrl:"src/shared/modal.html",controller:"ModalController"}),document.getElementById("Name").setAttribute("disabled",!0),document.getElementById("Word").setAttribute("disabled",!0),document.getElementById("Submit").setAttribute("disabled",!0)}function g(b){var d;return b===a.model.mangledWord&&0===a.deleteCounter?d=c.getMaxScore():(d=a.model.maxscore-a.deleteCounter,0>d&&(d=0)),d}a.model={show:!1},a.model.modal=!1;var h=function(b){a.model.mangledWord=b,a.model.show=!0,a.model.score=0,a.model.maxscore=c.getMaxScore(b.length);var d=40,e=document.querySelector("#counter");c.StartTimer(d,e)};a.init=function(){a.previousLength=0,a.deleteCounter=0,a.timerOut=!1,d.addListener("firstMangledWord",a,h),d.addListener("timeout",a,f)},a.$watch("name",function(){var a,b=document.getElementById("Name"),c=document.getElementById("Submit");null!==b&&(a=b.value,a.length>1&&c.hasAttribute("disabled")===!0&&c.removeAttribute("disabled"))}),a.$watch("word",function(){var b,c=document.getElementById("Word");null!==c&&(b=c.value,b.length>1&&a.previousLength<b.length?a.previousLength=b.length:b.length>1&&a.previousLength>=b.length&&(a.deleteCounter=a.deleteCounter+1,a.previousLength=b.length))}),a.submit=function(){var b=document.getElementById("Word").value,d=g(b);a.model.score=d;var e=document.getElementById("Name").value,f={name:e,score:d};c.submitScore(f).then(function(a){},function(){})},a.refresh=function(){b.getRandomWord()}},window.wordApp.wordEntryController.$inject=["$scope","WordsService","SaveScoreService","pubsubProvider","ModalService"],window.wordApp.controller("wordEntryController",window.wordApp.wordEntryController),window.wordApp.wordEntry=function(){return{restrict:"AE",templateUrl:"src/wordEntry/wordEntryTemplate.html"}},window.wordApp.directive("wordEntry",window.wordApp.wordEntry);